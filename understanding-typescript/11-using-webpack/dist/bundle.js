(()=>{"use strict";function e(e){let t=!0;return e.require&&(t=t&&0!==e.value.toString().trim().length),null!=e.minLength&&"string"===e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"===e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}class t{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function n(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var r;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(r||(r={}));class s{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s,this.id=Math.random().toString(),this.title=t,this.description=n,this.people=r}}class i{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}class l extends i{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new l),this.instance}addProject(e,t,n){const i=new s(Math.random().toString(),e,t,n,r.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const o=l.getInstance();class a extends t{constructor(e,t){super(e,t,!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}getherUserInput(){const t=this.titleInputElement.value,n=this.descriptionInputElement.value,r=this.peopleInputElement.value,s={value:n,require:!0,minLength:5},i={value:r,require:!0,min:1};if(e({value:t,require:!0})&&e(s)&&e(i))return[t,n,+r];console.error("Error! Fields must have value")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.getherUserInput();if(Array.isArray(t)){const[e,n,r]=t;o.addProject(e,n,r),this.clearInputs()}}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],a.prototype,"submitHandler",null);class c extends t{get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("DragEnd")}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],c.prototype,"dragStartHandler",null);var d=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class p extends t{constructor(e,t,n){super(e,t,!1,`${n}-projects`),this.type=n,this.assignedProjects=[],this.assignedProjects=[],this.configure(),this.renderContent()}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("drop",this.dropHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),o.addListener((e=>{const t=e.filter((e=>"active"===this.type?e.status===r.Active:e.status===r.Finished));this.assignedProjects=t,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");o.moveProject(t,"active"===this.type?r.Active:r.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new c(this.element.querySelector("ul").id,e)}}d([n],p.prototype,"dragOverHandler",null),d([n],p.prototype,"dropHandler",null),d([n],p.prototype,"dragLeaveHandler",null),new a("project-input","app"),new p("project-list","app","active"),new p("project-list","app","finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bEMsSUFBSWlDLEVBQVksZUFBZ0IsTUFBTyxVQUN2QyxJQUFJQSxFQUFZLGVBQWdCLE1BQU8sVyIsInNvdXJjZXMiOlsid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHMvLi9zcmMvdXRpbC92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHMvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXRzLy4vc3JjL2RlY29yYXRvcnMvYXV0b2JpbmQudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10cy8uL3NyYy9tb2R1bGVzL3Byb2plY3QudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10cy8uL3NyYy9zdGF0ZS9wcm9qZWN0LXN0YXRlLnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHMvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWlucHV0LnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHMvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWl0ZW0udHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10cy8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXRzLy4vc3JjL2FwcC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRhYmxlIHtcbiAgdmFsdWU6IHN0cmluZyB8IG51bWJlcjtcbiAgcmVxdWlyZT86IGJvb2xlYW47XG4gIG1pbkxlbmd0aD86IG51bWJlcjtcbiAgbWF4TGVuZ3RoPzogbnVtYmVyO1xuICBtaW4/OiBudW1iZXI7XG4gIG1heD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKFZhbGlkYXRhYmxlSW5wdXQ6IFZhbGlkYXRhYmxlKSB7XG4gIGxldCBpc1ZhbGlkID0gdHJ1ZTtcblxuICBpZiAoVmFsaWRhdGFibGVJbnB1dC5yZXF1aXJlKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgVmFsaWRhdGFibGVJbnB1dC52YWx1ZS50b1N0cmluZygpLnRyaW0oKS5sZW5ndGggIT09IDA7XG4gIH1cblxuICBpZiAoXG4gICAgVmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGggIT0gbnVsbCAmJlxuICAgIFZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09IFwic3RyaW5nXCJcbiAgKSB7XG4gICAgaXNWYWxpZCA9XG4gICAgICBpc1ZhbGlkICYmIFZhbGlkYXRhYmxlSW5wdXQudmFsdWUubGVuZ3RoID49IFZhbGlkYXRhYmxlSW5wdXQubWluTGVuZ3RoO1xuICB9XG5cbiAgaWYgKFxuICAgIFZhbGlkYXRhYmxlSW5wdXQubWF4TGVuZ3RoICE9IG51bGwgJiZcbiAgICBWYWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSBcInN0cmluZ1wiXG4gICkge1xuICAgIGlzVmFsaWQgPVxuICAgICAgaXNWYWxpZCAmJiBWYWxpZGF0YWJsZUlucHV0LnZhbHVlLmxlbmd0aCA8PSBWYWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aDtcbiAgfVxuXG4gIGlmIChcbiAgICBWYWxpZGF0YWJsZUlucHV0Lm1pbiAhPSBudWxsICYmXG4gICAgdHlwZW9mIFZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09IFwibnVtYmVyXCJcbiAgKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgVmFsaWRhdGFibGVJbnB1dC52YWx1ZSA+PSBWYWxpZGF0YWJsZUlucHV0Lm1pbjtcbiAgfVxuXG4gIGlmIChcbiAgICBWYWxpZGF0YWJsZUlucHV0Lm1heCAhPSBudWxsICYmXG4gICAgdHlwZW9mIFZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09IFwibnVtYmVyXCJcbiAgKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgVmFsaWRhdGFibGVJbnB1dC52YWx1ZSA8PSBWYWxpZGF0YWJsZUlucHV0Lm1heDtcbiAgfVxuXG4gIHJldHVybiBpc1ZhbGlkO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgYWJzdHJhY3QgY2xhc3MgQ29tcG9uZW50PFxuICBUIGV4dGVuZHMgSFRNTEVsZW1lbnQsXG4gIFUgZXh0ZW5kcyBIVE1MRWxlbWVudFxuPiB7XG4gIHRlbXBsYXRlRWxlbWVudDogSFRNTFRlbXBsYXRlRWxlbWVudDtcbiAgaG9zdEVsZW1lbnQ6IFQ7XG4gIGVsZW1lbnQ6IFU7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgdGVtcGxhdGVJZDogc3RyaW5nLFxuICAgIGhvc3RFbGVtZW50SWQ6IHN0cmluZyxcbiAgICBpbnNlcnRBdFN0YXJ0OiBib29sZWFuLFxuICAgIG5ld0VsZW1lbnRJZD86IHN0cmluZ1xuICApIHtcbiAgICB0aGlzLnRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxuICAgICAgdGVtcGxhdGVJZFxuICAgICkhIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XG4gICAgdGhpcy5ob3N0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvc3RFbGVtZW50SWQpISBhcyBUO1xuXG4gICAgY29uc3QgaW1wb3J0ZWROb2RlID0gZG9jdW1lbnQuaW1wb3J0Tm9kZShcbiAgICAgIHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsXG4gICAgICB0cnVlXG4gICAgKTtcbiAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgYXMgVTtcbiAgICBpZiAobmV3RWxlbWVudElkKSB7XG4gICAgICB0aGlzLmVsZW1lbnQuaWQgPSBuZXdFbGVtZW50SWQ7XG4gICAgfVxuXG4gICAgdGhpcy5hdHRhY2goaW5zZXJ0QXRTdGFydCk7XG4gIH1cblxuICBwcml2YXRlIGF0dGFjaChpbnNlcnRBdEJlZ2lubmluZzogYm9vbGVhbikge1xuICAgIHRoaXMuaG9zdEVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFxuICAgICAgaW5zZXJ0QXRCZWdpbm5pbmcgPyBcImFmdGVyYmVnaW5cIiA6IFwiYmVmb3JlZW5kXCIsXG4gICAgICB0aGlzLmVsZW1lbnRcbiAgICApO1xuICB9XG5cbiAgYWJzdHJhY3QgY29uZmlndXJlKCk6IHZvaWQ7XG4gIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZDtcbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBBdXRvQmluZChfOiBhbnksIF8xOiBzdHJpbmcsIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvcikge1xuICBjb25zdCBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XG4gIGNvbnN0IGFkakRlc2NyaXB0b3IgPSB7XG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIGdldCgpIHtcbiAgICAgIGNvbnN0IGJvdW5kRm4gPSBvcmlnaW5hbE1ldGhvZC5iaW5kKHRoaXMpO1xuXG4gICAgICByZXR1cm4gYm91bmRGbjtcbiAgICB9LFxuICB9O1xuXG4gIHJldHVybiBhZGpEZXNjcmlwdG9yO1xufVxuIiwiZXhwb3J0IGVudW0gUHJvamVjdFN0YXR1cyB7XG4gIEFjdGl2ZSxcbiAgRmluaXNoZWQsXG59XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0IHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIGlkOiBzdHJpbmcsXG4gICAgcHVibGljIHRpdGxlOiBzdHJpbmcsXG4gICAgcHVibGljIGRlc2NyaXB0aW9uOiBzdHJpbmcsXG4gICAgcHVibGljIHBlb3BsZTogbnVtYmVyLFxuICAgIHB1YmxpYyBzdGF0dXM6IFByb2plY3RTdGF0dXNcbiAgKSB7XG4gICAgdGhpcy5pZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKTtcbiAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgIHRoaXMucGVvcGxlID0gcGVvcGxlO1xuICB9XG59XG4iLCJpbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4vLi4vbW9kdWxlcy9wcm9qZWN0XCI7XG5cbnR5cGUgTGlzdGVuZXI8VD4gPSAoaXRlbXM6IFRbXSkgPT4gdm9pZDtcblxuY2xhc3MgU3RhdGU8VD4ge1xuICBwcm90ZWN0ZWQgbGlzdGVuZXJzOiBMaXN0ZW5lcjxUPltdID0gW107XG5cbiAgYWRkTGlzdGVuZXIobGlzdGVuZXJGbjogTGlzdGVuZXI8VD4pIHtcbiAgICB0aGlzLmxpc3RlbmVycy5wdXNoKGxpc3RlbmVyRm4pO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBTdGF0ZTxQcm9qZWN0PiB7XG4gIHByb2plY3RzOiBQcm9qZWN0W10gPSBbXTtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFByb2plY3RTdGF0ZTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKSB7XG4gICAgaWYgKCF0aGlzLmluc3RhbmNlKSB7XG4gICAgICB0aGlzLmluc3RhbmNlID0gbmV3IFByb2plY3RTdGF0ZSgpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5pbnN0YW5jZTtcbiAgfVxuXG4gIGFkZFByb2plY3QodGl0bGU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgcGVvcGxlOiBudW1iZXIpIHtcbiAgICBjb25zdCBuZXdQcm9qZWN0ID0gbmV3IFByb2plY3QoXG4gICAgICBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKCksXG4gICAgICB0aXRsZSxcbiAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgcGVvcGxlLFxuICAgICAgUHJvamVjdFN0YXR1cy5BY3RpdmVcbiAgICApO1xuXG4gICAgdGhpcy5wcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xuXG4gICAgdGhpcy51cGRhdGVMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIG1vdmVQcm9qZWN0KHByb2plY3RJZDogc3RyaW5nLCBuZXdTdGF0dXM6IFByb2plY3RTdGF0dXMpIHtcbiAgICBjb25zdCBwcm9qZWN0ID0gdGhpcy5wcm9qZWN0cy5maW5kKChlbCkgPT4gZWwuaWQgPT09IHByb2plY3RJZCk7XG5cbiAgICBpZiAocHJvamVjdCAmJiBwcm9qZWN0LnN0YXR1cyAhPT0gbmV3U3RhdHVzKSB7XG4gICAgICBwcm9qZWN0LnN0YXR1cyA9IG5ld1N0YXR1cztcbiAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVMaXN0ZW5lcnMoKSB7XG4gICAgZm9yIChjb25zdCBsaXN0ZW5lckZuIG9mIHRoaXMubGlzdGVuZXJzKSB7XG4gICAgICAvLyBQYXNzIGEgY29weSBvdCB0aGUgYXJyYXkgYnkgY2FsbGluZyAuc2xpY2UoKVxuICAgICAgbGlzdGVuZXJGbih0aGlzLnByb2plY3RzLnNsaWNlKCkpOyAvLyBUbyBwbGF5IGFyb3VuZCB3aXRoIHJlZmVycmVuY2VcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHByb2plY3RTdGF0ZSA9IFByb2plY3RTdGF0ZS5nZXRJbnN0YW5jZSgpO1xuIiwiaW1wb3J0ICogYXMgVmFsaWRhdGlvbiBmcm9tIFwiLi8uLi91dGlsL3ZhbGlkYXRpb25cIjtcbmltcG9ydCBDb21wb25lbnQgZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjtcbmltcG9ydCB7IEF1dG9CaW5kIH0gZnJvbSBcIi4vLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcblxuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEVsZW1lbnQ+IHtcbiAgcHJpdmF0ZSB0aXRsZUlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcbiAgcHJpdmF0ZSBkZXNjcmlwdGlvbklucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcbiAgcHJpdmF0ZSBwZW9wbGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgY29uc3RydWN0b3IodGVtcGxhdGVJZDogc3RyaW5nLCBob3N0SWQ6IHN0cmluZykge1xuICAgIHN1cGVyKHRlbXBsYXRlSWQsIGhvc3RJZCwgdHJ1ZSwgXCJ1c2VyLWlucHV0XCIpO1xuXG4gICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIjdGl0bGVcIlxuICAgICkhIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIjZGVzY3JpcHRpb25cIlxuICAgICkhIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiI3Blb3BsZVwiXG4gICAgKSEgYXMgSFRNTElucHV0RWxlbWVudDtcblxuICAgIHRoaXMuY29uZmlndXJlKCk7XG4gIH1cblxuICBjb25maWd1cmUoKSB7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5zdWJtaXRIYW5kbGVyKTtcbiAgfVxuXG4gIHJlbmRlckNvbnRlbnQoKSB7fVxuXG4gIHByaXZhdGUgZ2V0aGVyVXNlcklucHV0KCk6XG4gICAgfCBbdGl0bGU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgcGVvcGxlOiBudW1iZXJdXG4gICAgfCB2b2lkIHtcbiAgICBjb25zdCBlbnRlcmVkVGl0bGUgPSB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlO1xuICAgIGNvbnN0IGVudGVyZWREZXNjcmlwdGlvbiA9IHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQudmFsdWU7XG4gICAgY29uc3QgZW50ZXJlZFBlb3BsZSA9IHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlO1xuXG4gICAgY29uc3QgdGl0bGVWYWxpZGF0YWJsZTogVmFsaWRhdGlvbi5WYWxpZGF0YWJsZSA9IHtcbiAgICAgIHZhbHVlOiBlbnRlcmVkVGl0bGUsXG4gICAgICByZXF1aXJlOiB0cnVlLFxuICAgIH07XG5cbiAgICBjb25zdCBkZXNjdGlwdGlvblZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xuICAgICAgdmFsdWU6IGVudGVyZWREZXNjcmlwdGlvbixcbiAgICAgIHJlcXVpcmU6IHRydWUsXG4gICAgICBtaW5MZW5ndGg6IDUsXG4gICAgfTtcblxuICAgIGNvbnN0IHBlb3BsZVZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xuICAgICAgdmFsdWU6IGVudGVyZWRQZW9wbGUsXG4gICAgICByZXF1aXJlOiB0cnVlLFxuICAgICAgbWluOiAxLFxuICAgIH07XG5cbiAgICAvLyBpZihlbnRlcmVkVGl0bGUudHJpbSgpLmxlbmd0aCA9PT0gMCB8fCBlbnRlcmVkRGVzY3JpcHRpb24udHJpbSgpLmxlbmd0aCA9PT0gMCB8fCBlbnRlcmVkUGVvcGxlLnRyaW0oKS5sZW5ndGggPT09IDApe1xuICAgIGlmIChcbiAgICAgICFWYWxpZGF0aW9uLnZhbGlkYXRlKHRpdGxlVmFsaWRhdGFibGUpIHx8XG4gICAgICAhVmFsaWRhdGlvbi52YWxpZGF0ZShkZXNjdGlwdGlvblZhbGlkYXRhYmxlKSB8fFxuICAgICAgIVZhbGlkYXRpb24udmFsaWRhdGUocGVvcGxlVmFsaWRhdGFibGUpXG4gICAgKSB7XG4gICAgICAvLyBhbGVydCgnRXJyb3IhIEZpZWxkcyBtdXN0IGhhdmUgdmFsdWUnKVxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yISBGaWVsZHMgbXVzdCBoYXZlIHZhbHVlXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHJldHVybiBbZW50ZXJlZFRpdGxlLCBlbnRlcmVkRGVzY3JpcHRpb24sICtlbnRlcmVkUGVvcGxlXTtcbiAgfVxuXG4gIHByaXZhdGUgY2xlYXJJbnB1dHMoKTogdm9pZCB7XG4gICAgdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZSA9IFwiXCI7XG4gICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZSA9IFwiXCI7XG4gICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWUgPSBcIlwiO1xuICB9XG5cbiAgQEF1dG9CaW5kXG4gIHByaXZhdGUgc3VibWl0SGFuZGxlcihldmVudDogRXZlbnQpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgdXNlcklucHV0ID0gdGhpcy5nZXRoZXJVc2VySW5wdXQoKTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheSh1c2VySW5wdXQpKSB7XG4gICAgICBjb25zdCBbdGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGVdID0gdXNlcklucHV0O1xuICAgICAgcHJvamVjdFN0YXRlLmFkZFByb2plY3QodGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGUpO1xuICAgICAgdGhpcy5jbGVhcklucHV0cygpO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IENvbXBvbmVudCBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiO1xuaW1wb3J0IHsgRHJhZ2dhYmxlIH0gZnJvbSBcIi4uL21vZHVsZXMvZHJhZy1kcm9wXCI7XG5pbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4uL21vZHVsZXMvcHJvamVjdFwiO1xuaW1wb3J0IHsgQXV0b0JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xuXG5leHBvcnQgY2xhc3MgUHJvamVjdEl0ZW1cbiAgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTFVMaXN0RWxlbWVudCwgSFRNTExJRWxlbWVudD5cbiAgaW1wbGVtZW50cyBEcmFnZ2FibGVcbntcbiAgcHJpdmF0ZSBwcm9qZWN0OiBQcm9qZWN0O1xuXG4gIGdldCBwZXJzb25zKCkge1xuICAgIHJldHVybiB0aGlzLnByb2plY3QucGVvcGxlID09PSAxXG4gICAgICA/IFwiMSBwZXJzb25cIlxuICAgICAgOiBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZXJzb25zYDtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGhvc3RJZDogc3RyaW5nLCBwcm9qZWN0OiBQcm9qZWN0KSB7XG4gICAgc3VwZXIoXCJzaW5nbGUtcHJvamVjdFwiLCBob3N0SWQsIGZhbHNlLCBwcm9qZWN0LmlkKTtcbiAgICB0aGlzLnByb2plY3QgPSBwcm9qZWN0O1xuXG4gICAgdGhpcy5jb25maWd1cmUoKTtcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcbiAgfVxuXG4gIHJlbmRlckNvbnRlbnQoKSB7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJoMlwiKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJoM1wiKSEudGV4dENvbnRlbnQgPSB0aGlzLnBlcnNvbnMgKyBcIiBhc3NpZ25lZFwiO1xuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwicFwiKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XG4gIH1cblxuICBjb25maWd1cmUoKSB7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgdGhpcy5kcmFnU3RhcnRIYW5kbGVyKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdlbmRcIiwgdGhpcy5kcmFnRW5kSGFuZGxlcik7XG4gIH1cblxuICBAQXV0b0JpbmRcbiAgZHJhZ1N0YXJ0SGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XG4gICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5zZXREYXRhKFwidGV4dC9wbGFpblwiLCB0aGlzLnByb2plY3QuaWQpO1xuICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9IFwibW92ZVwiO1xuICB9XG5cbiAgZHJhZ0VuZEhhbmRsZXIoXzogRHJhZ0V2ZW50KTogdm9pZCB7XG4gICAgY29uc29sZS5sb2coXCJEcmFnRW5kXCIpO1xuICB9XG59XG4iLCJpbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tIFwiLi8uLi9zdGF0ZS9wcm9qZWN0LXN0YXRlXCI7XG5pbXBvcnQgQ29tcG9uZW50IGZyb20gXCIuL2Jhc2UtY29tcG9uZW50XCI7XG5pbXBvcnQgeyBEcmFnVGFyZ2V0IH0gZnJvbSBcIi4uL21vZHVsZXMvZHJhZy1kcm9wXCI7XG5pbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL21vZHVsZXMvcHJvamVjdFwiO1xuaW1wb3J0IHsgQXV0b0JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xuaW1wb3J0IHsgUHJvamVjdEl0ZW0gfSBmcm9tIFwiLi9wcm9qZWN0LWl0ZW1cIjtcblxuLy8gUHJvamVjdCBMaXN0XG5leHBvcnQgY2xhc3MgUHJvamVjdExpc3RcbiAgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxFbGVtZW50PlxuICBpbXBsZW1lbnRzIERyYWdUYXJnZXRcbntcbiAgYXNzaWduZWRQcm9qZWN0czogUHJvamVjdFtdID0gW107XG5cbiAgY29uc3RydWN0b3IoXG4gICAgdGVtcGxhdGVJZDogc3RyaW5nLFxuICAgIGhvc3RJZDogc3RyaW5nLFxuICAgIHByaXZhdGUgdHlwZTogXCJhY3RpdmVcIiB8IFwiZmluaXNoZWRcIlxuICApIHtcbiAgICBzdXBlcih0ZW1wbGF0ZUlkLCBob3N0SWQsIGZhbHNlLCBgJHt0eXBlfS1wcm9qZWN0c2ApO1xuXG4gICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gW107XG5cbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xuICB9XG5cbiAgY29uZmlndXJlKCkge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgdGhpcy5kcmFnT3ZlckhhbmRsZXIpO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCB0aGlzLmRyb3BIYW5kbGVyKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdsZWF2ZVwiLCB0aGlzLmRyYWdMZWF2ZUhhbmRsZXIpO1xuXG4gICAgcHJvamVjdFN0YXRlLmFkZExpc3RlbmVyKChwcm9qZWN0czogUHJvamVjdFtdKSA9PiB7XG4gICAgICBjb25zdCByZWxldmFudFByb2plY3RzID0gcHJvamVjdHMuZmlsdGVyKChwcm9qZWN0KSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnR5cGUgPT09IFwiYWN0aXZlXCIpIHtcbiAgICAgICAgICByZXR1cm4gcHJvamVjdC5zdGF0dXMgPT09IFByb2plY3RTdGF0dXMuQWN0aXZlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9qZWN0LnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5GaW5pc2hlZDtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gcmVsZXZhbnRQcm9qZWN0cztcbiAgICAgIHRoaXMucmVuZGVyUHJvamVjdHMoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbmRlckNvbnRlbnQoKSB7XG4gICAgY29uc3QgbGlzdElkID0gYCR7dGhpcy50eXBlfS1wcm9qZWN0cy1saXN0YDtcblxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwidWxcIikhLmlkID0gbGlzdElkO1xuXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJoMlwiKSEudGV4dENvbnRlbnQgPVxuICAgICAgdGhpcy50eXBlLnRvVXBwZXJDYXNlKCkgKyBcIiBQUk9KRUNUU1wiO1xuICB9XG5cbiAgQEF1dG9CaW5kXG4gIGRyYWdPdmVySGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XG4gICAgaWYgKGV2ZW50LmRhdGFUcmFuc2ZlciAmJiBldmVudC5kYXRhVHJhbnNmZXIudHlwZXNbMF0gPT09IFwidGV4dC9wbGFpblwiKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJ1bFwiKSEgYXMgSFRNTFVMaXN0RWxlbWVudDtcbiAgICAgIGxpc3RFbC5jbGFzc0xpc3QuYWRkKFwiZHJvcHBhYmxlXCIpO1xuICAgIH1cbiAgfVxuXG4gIEBBdXRvQmluZFxuICBkcm9wSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XG4gICAgY29uc3QgcHJqSWQgPSBldmVudC5kYXRhVHJhbnNmZXIhLmdldERhdGEoXCJ0ZXh0L3BsYWluXCIpO1xuICAgIHByb2plY3RTdGF0ZS5tb3ZlUHJvamVjdChcbiAgICAgIHByaklkLFxuICAgICAgdGhpcy50eXBlID09PSBcImFjdGl2ZVwiID8gUHJvamVjdFN0YXR1cy5BY3RpdmUgOiBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkXG4gICAgKTtcbiAgfVxuXG4gIEBBdXRvQmluZFxuICBkcmFnTGVhdmVIYW5kbGVyKF86IERyYWdFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwidWxcIikhIGFzIEhUTUxVTGlzdEVsZW1lbnQ7XG4gICAgbGlzdEVsLmNsYXNzTGlzdC5yZW1vdmUoXCJkcm9wcGFibGVcIik7XG4gIH1cblxuICBwcml2YXRlIHJlbmRlclByb2plY3RzKCkge1xuICAgIGNvbnN0IGxpc3RFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxuICAgICAgYCR7dGhpcy50eXBlfS1wcm9qZWN0cy1saXN0YFxuICAgICkhIGFzIEhUTUxVTGlzdEVsZW1lbnQ7XG4gICAgbGlzdEVsLmlubmVySFRNTCA9IFwiXCI7XG5cbiAgICBmb3IgKGNvbnN0IHByakl0ZW0gb2YgdGhpcy5hc3NpZ25lZFByb2plY3RzKSB7XG4gICAgICAvLyBjb25zdCBuZXdJdGVtID0gbmV3IE15UHJvamVjdEl0ZW0oJ2xpJywgcHJqSXRlbSwgbGlzdEVsKTtcbiAgICAgIC8vIG5ld0l0ZW0ucmVuZGVyKClcblxuICAgICAgbmV3IFByb2plY3RJdGVtKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwidWxcIikhLmlkLCBwcmpJdGVtKTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IFByb2plY3RJbnB1dCB9IGZyb20gXCIuL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dFwiO1xuaW1wb3J0IHsgUHJvamVjdExpc3QgfSBmcm9tIFwiLi9jb21wb25lbnRzL3Byb2plY3QtbGlzdFwiO1xuXG5uZXcgUHJvamVjdElucHV0KFwicHJvamVjdC1pbnB1dFwiLCBcImFwcFwiKTtcbm5ldyBQcm9qZWN0TGlzdChcInByb2plY3QtbGlzdFwiLCBcImFwcFwiLCBcImFjdGl2ZVwiKTtcbm5ldyBQcm9qZWN0TGlzdChcInByb2plY3QtbGlzdFwiLCBcImFwcFwiLCBcImZpbmlzaGVkXCIpO1xuIl0sIm5hbWVzIjpbInZhbGlkYXRlIiwiVmFsaWRhdGFibGVJbnB1dCIsImlzVmFsaWQiLCJyZXF1aXJlIiwidmFsdWUiLCJ0b1N0cmluZyIsInRyaW0iLCJsZW5ndGgiLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJtaW4iLCJtYXgiLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInRlbXBsYXRlSWQiLCJob3N0RWxlbWVudElkIiwiaW5zZXJ0QXRTdGFydCIsIm5ld0VsZW1lbnRJZCIsInRoaXMiLCJ0ZW1wbGF0ZUVsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaG9zdEVsZW1lbnQiLCJpbXBvcnRlZE5vZGUiLCJpbXBvcnROb2RlIiwiY29udGVudCIsImVsZW1lbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImlkIiwiYXR0YWNoIiwiaW5zZXJ0QXRCZWdpbm5pbmciLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJBdXRvQmluZCIsIl8iLCJfMSIsImRlc2NyaXB0b3IiLCJvcmlnaW5hbE1ldGhvZCIsImNvbmZpZ3VyYWJsZSIsImdldCIsImJpbmQiLCJQcm9qZWN0U3RhdHVzIiwiUHJvamVjdCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwZW9wbGUiLCJzdGF0dXMiLCJNYXRoIiwicmFuZG9tIiwiU3RhdGUiLCJsaXN0ZW5lcnMiLCJhZGRMaXN0ZW5lciIsImxpc3RlbmVyRm4iLCJwdXNoIiwiUHJvamVjdFN0YXRlIiwic3VwZXIiLCJwcm9qZWN0cyIsInN0YXRpYyIsImluc3RhbmNlIiwiYWRkUHJvamVjdCIsIm5ld1Byb2plY3QiLCJBY3RpdmUiLCJ1cGRhdGVMaXN0ZW5lcnMiLCJtb3ZlUHJvamVjdCIsInByb2plY3RJZCIsIm5ld1N0YXR1cyIsInByb2plY3QiLCJmaW5kIiwiZWwiLCJzbGljZSIsInByb2plY3RTdGF0ZSIsImdldEluc3RhbmNlIiwiUHJvamVjdElucHV0IiwiaG9zdElkIiwidGl0bGVJbnB1dEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQiLCJwZW9wbGVJbnB1dEVsZW1lbnQiLCJjb25maWd1cmUiLCJhZGRFdmVudExpc3RlbmVyIiwic3VibWl0SGFuZGxlciIsInJlbmRlckNvbnRlbnQiLCJnZXRoZXJVc2VySW5wdXQiLCJlbnRlcmVkVGl0bGUiLCJlbnRlcmVkRGVzY3JpcHRpb24iLCJlbnRlcmVkUGVvcGxlIiwiZGVzY3RpcHRpb25WYWxpZGF0YWJsZSIsInBlb3BsZVZhbGlkYXRhYmxlIiwiY29uc29sZSIsImVycm9yIiwiY2xlYXJJbnB1dHMiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcklucHV0IiwiQXJyYXkiLCJpc0FycmF5IiwiUHJvamVjdEl0ZW0iLCJwZXJzb25zIiwidGV4dENvbnRlbnQiLCJkcmFnU3RhcnRIYW5kbGVyIiwiZHJhZ0VuZEhhbmRsZXIiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsImxvZyIsIlByb2plY3RMaXN0IiwidHlwZSIsImFzc2lnbmVkUHJvamVjdHMiLCJkcmFnT3ZlckhhbmRsZXIiLCJkcm9wSGFuZGxlciIsImRyYWdMZWF2ZUhhbmRsZXIiLCJyZWxldmFudFByb2plY3RzIiwiZmlsdGVyIiwiRmluaXNoZWQiLCJyZW5kZXJQcm9qZWN0cyIsImxpc3RJZCIsInRvVXBwZXJDYXNlIiwidHlwZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJwcmpJZCIsImdldERhdGEiLCJyZW1vdmUiLCJpbm5lckhUTUwiLCJwcmpJdGVtIl0sInNvdXJjZVJvb3QiOiIifQ==